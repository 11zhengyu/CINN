This is a refactor for the previous CINN project.
